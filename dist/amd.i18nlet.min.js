define(function(){"use strict";var e="0.0.5";var t=false;var n="en";var i="{{";var r="}}";var o=null;var s="";var a="i";var g=true;var l=function(e){var t=[],n=arguments.length-1;while(n-- >0)t[n]=arguments[n+1];t.unshift("["+e.toUpperCase()+"]");t.unshift("[i18nlet]");try{console.log.apply(console,t)}catch(e){console.log(t)}};var h=function(e,t){var n=this;if(!this.store[e]){this.store[e]={}}Object.keys(t).forEach(function(i){n.store[e][i]=t[i]})};var u=function(e){var t=this;Object.keys(e).forEach(function(n){t.load(n,e[n])})};var f=function e(){};f.prototype.init=function f(c){var p=this;if(c===void 0)c={};this.version=e||"";this.store={};this.settings={};this.settings.currentLangage=this.settings.defaultLangage=c.defaultLangage||n;this.settings.debug=c.debug||t;this.settings.variableKeyPrefix=c.variableKeyPrefix||i;this.settings.variableKeySuffix=c.variableKeySuffix||r;this.settings.noConvertVariable=c.noConvertVariable||o;this.settings.reference=g;if(typeof c.reference==="boolean"){this.settings.reference=c.reference}this.settings.defaultText=s;if(typeof c.defaultText==="string"){this.settings.defaultText=c.defaultText}this.settings.getMessageFunctionName=c.getMessageFunctionName||a;this[this.settings.getMessageFunctionName]=this._i18nlet_get_message;this.regexpStr=this.settings.variableKeyPrefix+"(.+?)"+this.settings.variableKeySuffix;this.regexp=new RegExp(this.regexpStr,"g");this.logger={};this.logger.output=c.output||l;this.logger.debug=function(){var e=[],t=arguments.length;while(t--)e[t]=arguments[t];if(!p.settings.debug){return}e.unshift("DEBUG");p.logger.output.apply(null,e)};this.logger.error=function(e){var t=new Error("[i18nlet] "+e);p.logger.output.apply(null,["ERROR",t])};this.hook={load:h,loads:u};if(c.hook&&c.hook.load){this.logger.debug("hook load()");this.hook.load=c.hook.load}if(c.hook&&c.hook.loads){this.logger.debug("hook loads()");this.hook.loads=c.hook.loads}return this};f.prototype.load=function e(){this.hook.load.apply(this,arguments);return this};f.prototype.loads=function e(){this.hook.loads.apply(this,arguments);return this};f.prototype.changeLangage=function e(t){this.settings.currentLangage=t||this.settings.defaultLangage};f.prototype.currentLangage=function e(){return this.settings.currentLangage};f.prototype._getDefaultText=function e(t,n,i){if(typeof n!=="undefined"&&n!==null){return n}this.logger.debug("context not found. context:'"+t+"'");if(typeof i==="string"){return i}return this.settings.defaultText};f.prototype._i18nlet_get_message=function e(t,n,i){var r=this;n=n||{};i=i||{};if(typeof i.ref==="boolean"){i.ref=!!i.ref}else{i.ref=this.settings.reference}i.langage=i.langage?i.langage:this.currentLangage();var o=this.store[i.langage];if(!o||!o[t]){return this._getDefaultText(t,null,i.defaultText)}var s=o[t];if(!s){this.logger.debug("Context not found. '"+t+"'")}var a=s;var g;while(g=this.regexp.exec(a)){var l=n[g[1].trim()];if(!l){r.logger.debug("It can not convert the variable part. '"+g[0]+"' for '"+a+"'");a=typeof r.settings.noConvertVariable==="string"?a.replace(g[0],r.settings.noConvertVariable):a;continue}a=a.replace(g[0],l);r.regexp.lastIndex=0}if(!i.ref){return a}var h;while(h=this.regexp.exec(a)){var u=h[1].trim();var f=o[u];if(!f){r.logger.debug("It can not convert the constant part. '"+h[0]+"' for '"+a+"'");a=typeof r.settings.noConvertVariable==="string"?a.replace(h[0],r.settings.noConvertVariable):a;continue}a=a.replace(h[0],f);r.regexp.lastIndex=0}return a};return f});